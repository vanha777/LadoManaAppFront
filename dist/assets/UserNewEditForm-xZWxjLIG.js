import{at as B,au as k,a9 as M,aa as n,ca as b,cP as d,b$ as V,F as p,ab as $,ac as e,ad as A,aS as L,aN as T,cZ as G,an as x,by as I,bI as E,b6 as K,d1 as z,ag as i,bY as Q,ae as W,ak as Y,aM as y,d2 as C,ax as Z,al as J}from"./index-kAVNsXXW.js";import{G as u}from"./Grid-UjSMx0L8.js";import{C as S}from"./Card-yNtnckip.js";X.propTypes={isEdit:y.bool,currentUser:y.object};function X({isEdit:o=!1,currentUser:a}){function v(t){return t==="true"?"Đi Học":t==="pending"?"Tạm Dừng":"Nghỉ Học"}function w(t){return t==="true"?"success":t==="pending"?"warning":"error"}const r=B(),q=a==null?void 0:a.profile.date_of_birth.substring(0,10),{enqueueSnackbar:c}=k(),N=M().shape({firstName:n().required("Tên bắt buộc"),lastName:n().required("Họ bắt buộc"),email:n().notRequired().email("Email Không hợp lệ"),mobile:b().required("Số điện thoại bắt buộc"),address:n().notRequired(),dateOfBirth:d().required("Ngày sinh bắt buộc"),suburb:n().notRequired(),city:n().notRequired(),class:n().required("Môn học bắt buộc"),numberOfClass:b().required("Số Buổi Học bắt buộc"),status:n().required("Trạng Thái Đi Học bắt buộc"),postCode:n().notRequired(),avatarUrl:V().notRequired(),startDate1:d().required("Bắt đầu học bắt buộc"),startDate2:d().required("Bắt đầu học bắt buộc"),numberOfMonth:b().required("Thời gian hết hạn bắt buộc")}),m=p.useMemo(()=>{var t,l,s;return{firstName:(a==null?void 0:a.profile.first_name)||"",lastName:(a==null?void 0:a.profile.last_name)||"",email:((t=a==null?void 0:a.info)==null?void 0:t.email)||"",mobile:((l=a==null?void 0:a.info)==null?void 0:l.mobile)||"",address:((s=a==null?void 0:a.info)==null?void 0:s.address)||"",suburb:(a==null?void 0:a.info.suburb)||"",city:(a==null?void 0:a.info.city)||"",postCode:(a==null?void 0:a.info.post_code)||0,avatarUrl:(a==null?void 0:a.profile.avatar_url)||"",numberOfClass:(a==null?void 0:a.profile.number_of_class)||"",numberOfMonth:(a==null?void 0:a.profile.number_of_month)||"",status:(a==null?void 0:a.profile.status)||"false",dateOfBirth:q||"",class:(a==null?void 0:a.profile.class)||""}},[a]),f=$({resolver:J(N),defaultValues:m}),{reset:h,watch:D,control:H,setValue:g,handleSubmit:O,formState:{isSubmitting:R}}=f,j=D();p.useEffect(()=>{o&&a&&h(m),o||h(m)},[o,a]);const F=async t=>{try{if(!o){console.log("CREATE",t);const l=await C.post("http://127.0.0.1:3333/students",t,{withCredentials:!0});console.log("user.ID",l),await new Promise(s=>setTimeout(s,1e3)),c(o?"Update success!":"Create success!")}if(o){console.log("EDIT",t);const l=a==null?void 0:a.profile.user_id,s=await C.put(`http://127.0.0.1:3333/students/${l}`,t,{withCredentials:!0});console.log(s),await new Promise(_=>setTimeout(_,1e3)),c(o?"Update success!":"Create success!"),h(),r(Z.user.list)}}catch(l){console.error(l)}},P=p.useCallback(t=>{const l=t[0],s=Object.assign(l,{preview:URL.createObjectURL(l)});l&&g("avatarUrl",s,{shouldValidate:!0})},[g]);return e.jsx(A,{methods:f,onSubmit:O(F),children:e.jsxs(u,{container:!0,spacing:3,children:[e.jsx(u,{item:!0,xs:12,md:4,children:e.jsxs(S,{sx:{pt:10,pb:5,px:3},children:[e.jsx(L,{color:w(j.status),sx:{textTransform:"uppercase",position:"absolute",top:24,right:24},children:v(j.status)}),e.jsx(T,{sx:{mb:5},children:e.jsx(G,{name:"avatarUrl",maxSize:3145728,onDrop:P,helperText:e.jsxs(x,{variant:"caption",sx:{mt:2,mx:"auto",display:"block",textAlign:"center",color:"text.secondary"},children:["Cho Phép *.jpeg, *.jpg, *.png, *.gif",e.jsx("br",{})," Kích Thước Tối Đa ",I(3145728)]})})}),e.jsx(E,{name:"status",control:H,render:({field:{onChange:t,value:l}})=>e.jsx(K,{sx:{mx:0,mb:3,width:1,justifyContent:"space-between"},labelPlacement:"start",control:e.jsx(z,{checked:l==="true",onChange:s=>t(s.target.checked?"true":"pending")}),label:e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"subtitle2",sx:{mb:.5},children:"Trạng Thái"}),e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:"Tắt Trạng Thái Đi Học"})]})})}),e.jsx(i,{name:"numberOfClass",label:"Số Buổi Học",helperText:"Điều Chỉnh Số buổi học còn lại",type:"number",sx:{mb:2}}),e.jsx(i,{name:"numberOfMonth",label:"Số tháng",helperText:"Số tháng hết hạn",type:"number",sx:{mb:2}}),e.jsx(i,{name:"numberOfClassPerWeek",disabled:!0,label:"Số buổi",defaultValue:"2 buổi / 1 tuần",helperText:"Số buổi mỗi tuần",type:"string",sx:{mb:2}}),e.jsx(i,{name:"numberOfMinutePerClass",disabled:!0,label:"số tiếng",defaultValue:"1 tiếng / 1 buổi",helperText:"số giờ mỗi buổi",type:"string",sx:{mb:2}}),o?e.jsxs(e.Fragment,{children:[e.jsx(i,{name:"startDate1",type:"datetime-local",helperText:"Ngày học thứ nhất"}),e.jsx(i,{name:"startDate2",type:"datetime-local",helperText:"Ngày học thứ hai"})]}):e.jsxs(e.Fragment,{children:[" ",e.jsx(i,{name:"startDate1",type:"datetime-local",defaultValue:"2023-10-10T19:30",helperText:"Ngày học thứ nhất"}),e.jsx(i,{name:"startDate2",defaultValue:"2023-10-10T19:30",type:"datetime-local",helperText:"Ngày học thứ hai"})," "]})]})}),e.jsx(u,{item:!0,xs:12,md:8,children:e.jsxs(S,{sx:{p:3},children:[e.jsxs(T,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[e.jsx(i,{name:"firstName",label:"Tên"}),e.jsx(i,{name:"lastName",label:"Họ"}),e.jsxs(Q,{native:!0,name:"class",label:"Môn Học",children:[e.jsx("option",{value:""}),e.jsx("option",{value:"piano",children:"Piano"}),e.jsx("option",{value:"guitar",children:"Guitar"}),e.jsx("option",{value:"violin",children:"Violin"}),e.jsx("option",{value:"vocal",children:"Vocal"})]}),e.jsx(i,{name:"dateOfBirth",type:"date",helperText:"Ngày tháng năm sinh"}),e.jsx(i,{name:"email",label:"Địa Chỉ Email"}),e.jsx(i,{name:"mobile",label:"Số Điện Thoại"}),e.jsx(i,{name:"address",label:"Địa Chỉ"}),e.jsx(i,{name:"suburb",label:"Quận Huyện"}),e.jsx(i,{name:"city",label:"Thành Phố"}),e.jsx(i,{name:"postCode",label:"Mã Bưu Điện"})]}),e.jsx(W,{alignItems:"flex-end",sx:{mt:3},children:e.jsx(Y,{type:"submit",variant:"contained",loading:R,children:o?"Lưu Thay Đổi":"Tạo Học Sinh"})})]})})]})})}export{X as U};
