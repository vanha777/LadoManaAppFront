import{F as p,ac as e,b7 as re,ae as z,aQ as ae,an as le,aS as U,ai as $,aj as g,b3 as ie,b4 as D,aD as k,aM as l,bi as W,ah as ce,aA as de,au as he,at as ue,as as me,aB as fe,ax as N,ap as pe,b2 as xe,be as ge,aP as je}from"./index-kAVNsXXW.js";import{C as V}from"./ConfirmDialog-XnXcLk1r.js";import{C as be}from"./CustomBreadcrumbs-07KkEdSP.js";import{e as Ce,g as Te}from"./utils-BH68Vpzu.js";import{u as Se}from"./useTable-l4SK5Cxu.js";import{a as ve,T as we,b as Re,c as _e,d as ye}from"./TablePaginationCustom-D5U7UEwi.js";import{c as Pe,T as ke,a as Ee,b as Fe}from"./TableRow-zrsFapiu.js";import{T as x}from"./TableCell-7incTXUx.js";import{C as He}from"./Card-yNtnckip.js";import{T as Ie,a as Ae}from"./Tabs-vRgd6uc9.js";import{p as Ne}from"./index-7OLVL5xd.js";import"./DialogTitle-vCHwm-ka.js";import"./dialogTitleClasses-wpKycvDL.js";import"./DialogContent-DKzr_HVR.js";import"./DialogActions-vKtJfWwg.js";import"./EmptyContent-vRT2zqjA.js";import"./TablePagination-Vshr5hr6.js";import"./KeyboardArrowRight-6uRlvlB4.js";import"./LastPage-N6rQPigF.js";async function X(t,o={},d){return window.__TAURI_INTERNALS__.invoke(t,o,d)}q.propTypes={row:l.object,selected:l.bool,onEditRow:l.func,onDeleteRow:l.func,onSelectRow:l.func};function q({row:t,selected:o,onEditRow:d,onSelectRow:u,onDeleteRow:r}){function h(i){return i==="true"?"Đi Học":i==="pending"?"Tạm Dừng":"Nghỉ Học"}function s(i){return i==="true"?"success":i==="pending"?"warning":"error"}const{id:m,user_id:C,first_name:T,last_name:E,avatar_url:F,date_of_birth:H,number_of_class:v,status:w}=t,R=new Date(H).toLocaleDateString(),[I,f]=p.useState(!1),[S,_]=p.useState(null),A=()=>{f(!0)},y=()=>{f(!1)},j=i=>{_(i.currentTarget)},b=()=>{_(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{hover:!0,selected:o,children:[e.jsx(x,{padding:"checkbox",children:e.jsx(re,{checked:o,onClick:u})}),e.jsx(x,{children:e.jsxs(z,{direction:"row",alignItems:"center",spacing:2,children:[e.jsx(ae,{alt:`${T}`,src:F}),e.jsx(le,{variant:"subtitle2",noWrap:!0,children:`${E} ${T}`})]})}),e.jsx(x,{align:"left",children:R}),e.jsx(x,{align:"left",sx:{textTransform:"capitalize"},children:t.class}),e.jsx(x,{align:"center",children:e.jsx(U,{variant:"soft",color:v<5&&"error"||"success",children:v})}),e.jsx(x,{align:"left",children:e.jsx(U,{variant:"soft",color:s(w),sx:{textTransform:"capitalize"},children:h(w)})}),e.jsx(x,{align:"right",children:e.jsx($,{color:S?"inherit":"default",onClick:j,children:e.jsx(g,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(ie,{open:S,onClose:b,arrow:"right-top",sx:{width:140},children:[e.jsxs(D,{onClick:()=>{A(),b()},sx:{color:"error.main"},children:[e.jsx(g,{icon:"eva:trash-2-outline"}),"Xóa"]}),e.jsxs(D,{onClick:()=>{d(),b()},children:[e.jsx(g,{icon:"eva:edit-fill"}),"Chi Tiết"]})]}),e.jsx(V,{open:I,onClose:y,title:"Xóa",content:"Bạn có chắc chắn muốn xóa?",action:e.jsx(k,{variant:"contained",color:"error",onClick:r,children:"Xóa"})})]})}G.propTypes={isFiltered:l.bool,filterName:l.string,filterRole:l.string,onFilterName:l.func,onFilterRole:l.func,onResetFilter:l.func,optionsRole:l.arrayOf(l.string)};function G({isFiltered:t,filterName:o,filterRole:d,optionsRole:u,onFilterName:r,onFilterRole:h,onResetFilter:s}){return e.jsxs(z,{spacing:2,alignItems:"center",direction:{xs:"column",sm:"row"},sx:{px:2.5,py:3},children:[e.jsx(W,{fullWidth:!0,select:!0,label:"Môn Học",value:d,onChange:h,SelectProps:{MenuProps:{PaperProps:{sx:{maxHeight:260}}}},sx:{maxWidth:{sm:240},textTransform:"capitalize"},children:u.map(m=>e.jsx(D,{value:m,sx:{mx:1,borderRadius:.75,typography:"body2",textTransform:"capitalize"},children:m},m))}),e.jsx(W,{fullWidth:!0,value:o,onChange:r,placeholder:"Tìm Kiếm...",InputProps:{startAdornment:e.jsx(ce,{position:"start",children:e.jsx(g,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}),t&&e.jsx(k,{color:"error",sx:{flexShrink:0},onClick:s,startIcon:e.jsx(g,{icon:"eva:trash-2-outline"}),children:"Xóa tìm kiếm"})]})}const De=["Tất cả","Đi Học","Tạm Dừng","Nghỉ Học"],Oe=["tất cả","piano","guitar","violin","vocal"],Be=[{id:"name",label:"Tên",align:"left"},{id:"date_of_birth",label:"Ngày Sinh",align:"left"},{id:"class",label:"Môn Học",align:"left"},{id:"number_of_class",label:"Số Buổi Học",align:"center"},{id:"status",label:"Trạng Thái",align:"left"},{id:""}];function rn(){const{dense:t,page:o,order:d,orderBy:u,rowsPerPage:r,setPage:h,selected:s,setSelected:m,onSelectRow:C,onSelectAllRows:T,onSort:E,onChangeDense:F,onChangePage:H,onChangeRowsPerPage:v}=Se(),{themeStretch:w}=de(),{enqueueSnackbar:R}=he(),I=ue(),[f,S]=p.useState([]),_=async()=>{try{const n=await X("get_all_student");return console.log("Invoke fn from Rust BE:",n),n}catch(n){return console.error("Error:",n),[[{id:1,first_name:"Error",last_name:"",date_of_birth:"",class:"",number_of_class:1,status:"false"}]]}};p.useEffect(()=>{(async()=>{const a=await _();await S(a)})()},[]);const[A,y]=p.useState(!1),[j,b]=p.useState(""),[i,O]=p.useState("tất cả"),[P,B]=p.useState("tất cả"),c=Le({inputData:f,comparator:Te(d,u),filterName:j,filterRole:i,filterStatus:P}),K=c.slice(o*r,o*r+r),Q=t?52:72,J=j!==""||i!=="all"||P!=="all",Y=!(c!=null&&c.length)&&!!j||!(c!=null&&c.length)&&!!i||!(c!=null&&c.length)&&!!P,Z=()=>{y(!0)},L=()=>{y(!1)},ee=(n,a)=>{h(0),B(a)},ne=n=>{h(0),b(n.target.value)},te=n=>{h(0),O(n.target.value)},M=async n=>{console.log("this is delete id",n);try{const a=await X("delete_student",{id:n});console.log("Invoke fn from Rust BE:",a),R("Delete success!"),await S(a)}catch(a){console.error("Error:",a),R("Delete Error!",a)}o>0&&K.length<2&&h(o-1)},se=n=>{console.log(`selected ${n}`),I(N.user.edit(Ne(`${n}`)))},oe=()=>{b(""),O("tất cả"),B("tất cả")};return e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsx("title",{children:" User: List | Minimal UI"})}),e.jsxs(fe,{maxWidth:w?!1:"lg",children:[e.jsx(be,{heading:"Danh Sách Học Viên",links:[{name:"Trang Chủ",href:N.root},{name:"Học Viên"}],action:e.jsx(k,{component:pe,to:N.user.new,variant:"contained",startIcon:e.jsx(g,{icon:"eva:plus-fill"}),children:"Ghi Danh"})}),e.jsxs(He,{children:[e.jsx(Ie,{value:P,onChange:ee,sx:{px:2,bgcolor:"background.neutral"},children:De.map(n=>e.jsx(Ae,{label:n,value:n},n))}),e.jsx(xe,{}),e.jsx(G,{isFiltered:J,filterName:j,filterRole:i,optionsRole:Oe,onFilterName:ne,onFilterRole:te,onResetFilter:oe}),e.jsxs(ke,{sx:{position:"relative",overflow:"unset"},children:[e.jsx(ve,{dense:t,numSelected:s.length,rowCount:f.length,onSelectAllRows:n=>T(n,f.map(a=>a[0].id)),action:e.jsx(ge,{title:"Xóa",children:e.jsx($,{color:"primary",onClick:Z,children:e.jsx(g,{icon:"eva:trash-2-outline"})})})}),e.jsx(je,{children:e.jsxs(Ee,{size:t?"small":"medium",sx:{minWidth:800},children:[e.jsx(we,{order:d,orderBy:u,headLabel:Be,rowCount:f.length,numSelected:s.length,onSort:E,onSelectAllRows:n=>T(n,f.map(a=>a[0].id))}),e.jsxs(Fe,{children:[c.slice(o*r,o*r+r).map(n=>e.jsx(q,{row:n[0],selected:s.includes(n[0].id),onSelectRow:()=>C(n[0].id),onDeleteRow:()=>M(n[0].id),onEditRow:()=>se(n[0].id)},n[0].id)),e.jsx(Re,{height:Q,emptyRows:Ce(o,r,f.length)}),e.jsx(_e,{isNotFound:Y})]})]})})]}),e.jsx(ye,{count:c.length,page:o,rowsPerPage:r,onPageChange:H,onRowsPerPageChange:v,dense:t,onChangeDense:F})]})]}),e.jsx(V,{open:A,onClose:L,title:"Xóa",content:e.jsxs(e.Fragment,{children:["Bạn có chắc chắn muốn xóa ",e.jsxs("strong",{children:[" ",s.length," "]})," items?"]}),action:e.jsx(k,{variant:"contained",color:"error",onClick:()=>{M(s),L()},children:"Xóa"})})]})}function Le({inputData:t,comparator:o,filterName:d,filterStatus:u,filterRole:r}){const h=t.map((s,m)=>[s,m]);return console.log(t),h.sort((s,m)=>{const C=o(s[0],m[0]);return C!==0?C:s[1]-m[1]}),t=h.map(s=>s[0]),d&&(t=t.filter(s=>s[0].last_name.toLowerCase().indexOf(d.toLowerCase())!==-1)),u==="Đi Học"&&(t=t.filter(s=>s[0].status==="true")),u==="Tạm Dừng"&&(t=t.filter(s=>s[0].status==="pending")),u==="Nghỉ Học"&&(t=t.filter(s=>s[0].status==="false")),r!=="tất cả"&&(console.log(r),t=t.filter(s=>s[0].class===r)),t}export{rn as default};
