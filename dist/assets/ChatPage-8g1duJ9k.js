import{ei as Q,ej as Re,ek as Ne,el as Ae,em as De,en as M,eo as H,ep as Pe,aM as a,ac as e,cM as U,dE as X,cv as A,dF as Z,ae as m,an as S,eq as D,at as B,bl as G,dG as ee,er as Me,ah as se,aj as u,a8 as _e,F as f,b3 as Oe,be as Ee,ai as b,b2 as te,b4 as z,c5 as We,bS as ne,aQ as P,az as oe,bJ as _,aJ as ae,aN as I,ap as Le,ax as N,aP as E,bV as ze,aD as Fe,es as Ue,et as Be,bx as Ge,b9 as $e,dK as He,bh as qe,bj as Ve,aO as Ye,cQ as Ke,ao as Je,b8 as Qe,bR as Xe,bi as Ze,bT as es,bU as ss,aL as ts,bp as ns,aA as os,bF as as,eu as rs,c0 as is,bW as q,ev as ls,ew as cs,ex as ds,ey as hs,ez as xs,aB as ps,eA as us,eB as ms,eC as fs,eD as js,as as gs}from"./index-kAVNsXXW.js";import{C as vs}from"./CustomBreadcrumbs-07KkEdSP.js";import{S as ys}from"./SkeletonConversationItem-L95VVb_N.js";import{a as bs}from"./IncrementerButton-SLvR_Q0x.js";import{D as Cs}from"./DialogContent-DKzr_HVR.js";import{u as ws}from"./uuidv4-aWC4thH7.js";import{L as Ss}from"./Lightbox-_JL-soEW.js";import{C as Ts}from"./Card-yNtnckip.js";import"./Skeleton-ET3ifG4q.js";import"./dialogTitleClasses-wpKycvDL.js";var V=1e3*60,O=60*24,Y=O*30,K=O*365;function Is(s,o,t){var r,n,i;Q(2,arguments);var c=Pe(),l=(r=(n=t==null?void 0:t.locale)!==null&&n!==void 0?n:c.locale)!==null&&r!==void 0?r:Re;if(!l.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var d=Ne(s,o);if(isNaN(d))throw new RangeError("Invalid time value");var x=Ae(De(t),{addSuffix:!!(t!=null&&t.addSuffix),comparison:d}),h,y;d>0?(h=M(o),y=M(s)):(h=M(s),y=M(o));var v=String((i=t==null?void 0:t.roundingMethod)!==null&&i!==void 0?i:"round"),j;if(v==="floor")j=Math.floor;else if(v==="ceil")j=Math.ceil;else if(v==="round")j=Math.round;else throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");var T=y.getTime()-h.getTime(),C=T/V,p=H(y)-H(h),w=(T-p)/V,k=t==null?void 0:t.unit,g;if(k?g=String(k):C<1?g="second":C<60?g="minute":C<O?g="hour":w<Y?g="day":w<K?g="month":g="year",g==="second"){var R=j(T/1e3);return l.formatDistance("xSeconds",R,x)}else if(g==="minute"){var L=j(C);return l.formatDistance("xMinutes",L,x)}else if(g==="hour"){var Te=j(C/60);return l.formatDistance("xHours",Te,x)}else if(g==="day"){var Ie=j(w/O);return l.formatDistance("xDays",Ie,x)}else if(g==="month"){var $=j(w/Y);return $===12&&k!=="month"?l.formatDistance("xYears",1,x):l.formatDistance("xMonths",$,x)}else if(g==="year"){var ke=j(w/K);return l.formatDistance("xYears",ke,x)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}function re(s,o){return Q(1,arguments),Is(s,Date.now(),o)}ie.propTypes={openNav:a.bool,onSelect:a.func,isSelected:a.bool,conversation:a.object,ccData:a.object};function ie({conversation:s,openNav:o,isSelected:t,onSelect:r,ccData:n}){return console.log(n.to.profile.first_name),e.jsxs(U,{disableGutters:!0,onClick:r,sx:{py:1.5,px:2.5,...t&&{bgcolor:"action.selected"}},children:[e.jsx(X,{children:e.jsx(A,{alt:n.to.profile.first_name,src:n.to.profile.avatar_url,sx:{width:48,height:48}},n.to.to_id)}),o&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{primary:n.to.profile.first_name,primaryTypographyProps:{noWrap:!0,variant:"subtitle2"},secondary:"testtestest",secondaryTypographyProps:{noWrap:!0,variant:"subtitle2",color:"text.primary"}}),e.jsxs(m,{alignItems:"flex-end",sx:{ml:2,height:44},children:[e.jsx(S,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:re(new Date(101010),{addSuffix:!1})}),e.jsx(D,{status:"unread",size:"small"})]})]})]})}le.propTypes={sx:a.object,openNav:a.bool,selected:a.func,onCloseNav:a.func,conversations:a.object,ccData:a.array};function le({conversations:s,openNav:o,onCloseNav:t,selected:r,ccData:n,sx:i,...c}){B();const l=G("up","md"),d=!s.allIds.length;return e.jsx(ee,{disablePadding:!0,sx:i,...c,children:(d?[...Array(12)]:n).map((x,h)=>x?e.jsx(ie,{ccData:x,openNav:o,onSelect:()=>{l||t()}}):e.jsx(ys,{},h))})}ce.propTypes={value:a.string,onChange:a.func,onClickAway:a.func};function ce({value:s,onChange:o,onClickAway:t}){return e.jsx(Me,{onClickAway:t,children:e.jsx(bs,{fullWidth:!0,size:"small",value:s,onChange:o,placeholder:"Search contacts...",InputProps:{startAdornment:e.jsx(se,{position:"start",children:e.jsx(u,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})},sx:{mt:2.5}})})}const ks=["online","invisible","away"];function Rs(){const{user:s}=_e(),[o,t]=f.useState("online"),[r,n]=f.useState(null),i=l=>{n(l.currentTarget)},c=()=>{n(null)};return e.jsxs(e.Fragment,{children:[e.jsx(A,{src:s==null?void 0:s.avatar_url,alt:s==null?void 0:s.first_name,name:s==null?void 0:s.first_name,BadgeProps:{badgeContent:e.jsx(D,{status:o})},onClick:i,sx:{cursor:"pointer",width:48,height:48}}),e.jsxs(Oe,{open:r,onClose:c,arrow:"top-left",sx:{p:0},children:[e.jsxs(m,{direction:"row",alignItems:"center",spacing:2,sx:{py:2,pr:1,pl:2.5},children:[e.jsxs("div",{children:[e.jsx(S,{noWrap:!0,variant:"subtitle2",children:s==null?void 0:s.first_name}),e.jsx(S,{noWrap:!0,variant:"body2",sx:{color:"text.secondary"},children:s==null?void 0:s.email})]}),e.jsx(Ee,{title:"Log out",children:e.jsx(b,{color:"error",children:e.jsx(u,{icon:"ic:round-power-settings-new"})})})]}),e.jsx(te,{}),e.jsxs(ee,{sx:{px:1},children:[e.jsxs(z,{children:[e.jsx(D,{size:"large",status:o,sx:{m:.5,flexShrink:0}}),e.jsx(We,{native:!0,fullWidth:!0,value:o,onChange:l=>t(l.target.value),sx:{"& .MuiInputBase-input":{p:0,pl:2,typography:"body2",textTransform:"capitalize"},"& .MuiNativeSelect-icon":{right:-16,top:"unset"},"& .MuiOutlinedInput-notchedOutline":{display:"none"}},children:ks.map(l=>e.jsx("option",{value:l,children:l},l))})]}),e.jsxs(z,{children:[e.jsx(u,{icon:"ic:round-account-box"}),"Profile"]}),e.jsxs(z,{children:[e.jsx(u,{icon:"eva:settings-2-fill"}),"Settings"]})]})]})]})}de.propTypes={searchResults:a.array,onSelectContact:a.func,searchContacts:a.string};function de({searchContacts:s,searchResults:o,onSelectContact:t}){const r=!o.length&&!!s;return e.jsxs(e.Fragment,{children:[e.jsx(S,{paragraph:!0,variant:"h6",sx:{px:2.5},children:"Contacts"}),r?e.jsx(ne,{query:s,sx:{p:3,mx:"auto",width:"calc(100% - 40px)",bgcolor:"background.neutral"}}):e.jsx(e.Fragment,{children:o.map(n=>e.jsxs(U,{onClick:()=>t(n),sx:{px:2.5,py:1.5,typography:"subtitle2"},children:[e.jsx(P,{alt:n.name,src:n.avatar,sx:{mr:2}}),n.name]},n.id))})]})}const Ns=ae(s=>e.jsx(b,{disableRipple:!0,...s}))(({theme:s})=>({left:0,zIndex:9,width:32,height:32,position:"absolute",top:s.spacing(13),borderRadius:"0 12px 12px 0",color:s.palette.primary.contrastText,backgroundColor:s.palette.primary.main,boxShadow:s.customShadows.primary,"&:hover":{backgroundColor:s.palette.primary.darker}})),J=320,As=96;he.propTypes={conversations:a.object,activeConversationId:a.string,ccData:a.array};function he({conversations:s,activeConversationId:o,ccData:t}){const r=oe(),n=B(),i=G("up","md"),[c,l]=f.useState(!1),[d,x]=f.useState([]),[h,y]=f.useState(""),v=i&&!c;f.useEffect(()=>{i?T():C()},[i]);const j=()=>{l(!c)},T=()=>{l(!0)},C=()=>{l(!1)},p=async g=>{try{const{value:R}=g.target;if(y(R),R){const L=await ze.get("/api/chat/search",{params:{query:R}});x(L.data.results)}else x([])}catch(R){console.error(R)}},w=g=>{y(""),n(N.chat.view(g.username))},k=e.jsxs(e.Fragment,{children:[e.jsxs(I,{sx:{p:2.5},children:[e.jsxs(m,{direction:"row",alignItems:"center",justifyContent:"center",children:[!v&&e.jsxs(e.Fragment,{children:[e.jsx(Rs,{}),e.jsx(I,{sx:{flexGrow:1}})]}),e.jsx(b,{onClick:j,children:e.jsx(u,{icon:c?"eva:arrow-ios-back-fill":"eva:arrow-ios-forward-fill"})}),!v&&e.jsx(b,{component:Le,to:N.chat.new,children:e.jsx(u,{icon:"eva:edit-fill"})})]}),!v&&e.jsx(ce,{value:h,onChange:p,onClickAway:()=>y("")})]}),e.jsx(E,{children:h?e.jsx(de,{searchContacts:h,searchResults:d,onSelectContact:w}):e.jsx(le,{openNav:c,ccData:t,onCloseNav:C,conversations:s,selected:g=>o===g})})]});return e.jsxs(e.Fragment,{children:[!i&&e.jsx(Ns,{onClick:j,children:e.jsx(u,{width:16,icon:"eva:people-fill"})}),i?e.jsx(_,{open:c,variant:"persistent",PaperProps:{sx:{pb:1,width:1,position:"static",...v&&{transform:"none !important",visibility:"visible !important"}}},sx:{width:J,transition:r.transitions.create("width"),...v&&{width:As}},children:k}):e.jsx(_,{open:c,onClose:C,ModalProps:{keepMounted:!0},PaperProps:{sx:{pb:1,width:J}},children:k})]})}W.propTypes={sx:a.object,children:a.node,isCollapse:a.bool,onCollapse:a.func};function W({isCollapse:s,onCollapse:o,children:t,sx:r,...n}){return e.jsx(Fe,{fullWidth:!0,color:"inherit",onClick:o,endIcon:e.jsx(u,{width:16,icon:s?"eva:arrow-ios-downward-fill":"eva:arrow-ios-forward-fill"}),sx:{height:40,flexShrink:0,borderRadius:0,typography:"overline",color:"text.disabled",justifyContent:"space-between",p:i=>i.spacing(1,1.5,1,2.5),...r},...n,children:t})}xe.propTypes={conversation:a.object,isCollapse:a.bool,onCollapse:a.func};function xe({conversation:s,isCollapse:o,onCollapse:t}){const r=Ue(Be(s.messages.map(n=>n.attachments)));return e.jsxs(m,{flexGrow:1,sx:{pb:2,height:1,overflow:"hidden",borderTop:n=>`solid 1px ${n.palette.divider}`},children:[e.jsxs(W,{isCollapse:o&&!!r.length,onCollapse:t,disabled:!r.length,sx:{...!o&&{borderBottom:n=>`solid 1px ${n.palette.divider}`}},children:["Attachments (",r.length,")"]}),e.jsx(I,{sx:{overflow:"hidden",height:o?1:0,transition:n=>n.transitions.create("height",{duration:n.transitions.duration.shorter})},children:e.jsx(E,{children:r.map((n,i)=>e.jsx(pe,{attachment:n},n.name+i))})})]})}pe.propTypes={attachment:a.object};function pe({attachment:s}){return e.jsxs(m,{direction:"row",alignItems:"center",sx:{mt:2,px:2.5},children:[e.jsx(m,{alignItems:"center",justifyContent:"center",sx:{width:40,height:40,flexShrink:0,borderRadius:1,overflow:"hidden",position:"relative",backgroundColor:"background.neutral"},children:e.jsx(Ge,{imageView:!0,file:s.preview,onDownload:()=>console.log("DOWNLOAD"),sx:{width:28,height:28}})}),e.jsxs(m,{flexGrow:1,sx:{ml:1.5,minWidth:0},children:[e.jsx(S,{variant:"body2",noWrap:!0,children:s.name}),e.jsx(S,{noWrap:!0,variant:"caption",sx:{color:"text.secondary",display:"block"},children:$e(s.dateCreated)})]})]})}ue.propTypes={isCollapse:a.bool,onCollapse:a.func,participant:a.object};function ue({participant:s,isCollapse:o,onCollapse:t}){return s?e.jsxs("div",{children:[e.jsxs(m,{alignItems:"center",sx:{py:4},children:[e.jsx(P,{alt:s.name,src:s.avatar,sx:{width:96,height:96,mb:2}}),e.jsx(S,{variant:"subtitle1",children:s.name}),e.jsx(S,{variant:"body2",sx:{color:"text.secondary",mt:.5},children:s.role})]}),e.jsx(te,{}),e.jsx(W,{isCollapse:o,onCollapse:t,children:"information"}),e.jsx(He,{in:o,children:e.jsx(m,{spacing:2,sx:{p:r=>r.spacing(2,2.5,2.5,2.5)},children:[{icon:"eva:pin-fill",value:s.address},{icon:"eva:phone-fill",value:s.phone},{icon:"eva:email-fill",value:s.email}].map((r,n)=>e.jsxs(m,{direction:"row",children:[e.jsx(u,{icon:r.icon,sx:{mr:1,mt:.5,flexShrink:0,color:"text.disabled"}}),e.jsx(S,{variant:"body2",noWrap:n===2,children:r.value})]},r.icon))})})]}):null}me.propTypes={open:a.bool,onClose:a.func,participant:a.object};function me({participant:s,open:o,onClose:t}){const{name:r,avatar:n,role:i,address:c}=s;return e.jsxs(qe,{fullWidth:!0,maxWidth:"xs",open:o,onClose:t,children:[e.jsx(b,{onClick:t,sx:{position:"absolute",right:8,top:8},children:e.jsx(u,{icon:"eva:close-fill"})}),e.jsx(Cs,{sx:{p:5},children:e.jsxs(m,{direction:"row",spacing:3,children:[e.jsx(A,{alt:r,src:n,name:r,sx:{width:96,height:96}}),e.jsxs(m,{spacing:1,children:[e.jsx(S,{variant:"caption",sx:{color:"primary.main"},children:i}),e.jsx(S,{variant:"h6",children:r}),e.jsxs(m,{direction:"row",sx:{typography:"caption",color:"text.secondary"},children:[e.jsx(u,{icon:"eva:pin-fill",width:16,sx:{flexShrink:0,mr:.5}}),c]}),e.jsxs(m,{direction:"row",sx:{pt:1},children:[e.jsx(b,{color:"info",children:e.jsx(u,{icon:"eva:message-square-fill"})}),e.jsx(b,{color:"warning",children:e.jsx(u,{icon:"eva:email-fill"})}),e.jsx(b,{color:"success",children:e.jsx(u,{icon:"eva:phone-fill"})}),e.jsx(b,{color:"error",children:e.jsx(u,{icon:"eva:video-fill"})})]})]})]})})]})}const fe=60;je.propTypes={isCollapse:a.bool,onCollapse:a.func,participants:a.array,onOpenUserInfo:a.func,selectUserId:a.string};function je({participants:s,selectUserId:o,onOpenUserInfo:t,isCollapse:r,onCollapse:n}){return e.jsxs(e.Fragment,{children:[e.jsxs(W,{isCollapse:r,onCollapse:n,children:["In room (",s.length,")"]}),e.jsx(I,{sx:{height:r?fe*4:0,transition:i=>i.transitions.create("height",{duration:i.transitions.duration.shorter})},children:e.jsx(E,{children:s.map(i=>e.jsx(ge,{participant:i,open:o===i.id,onOpen:()=>t(i.id),onClose:()=>t(null)},i.id))})})]})}ge.propTypes={open:a.bool,onOpen:a.func,onClose:a.func,participant:a.object};function ge({participant:s,open:o,onClose:t,onOpen:r}){const{name:n,avatar:i,status:c,role:l}=s;return e.jsxs(e.Fragment,{children:[e.jsxs(U,{onClick:r,sx:{height:fe,px:2.5},children:[e.jsx(X,{children:e.jsx(A,{alt:n,src:i,BadgeProps:{badgeContent:e.jsx(D,{status:c})}})}),e.jsx(Z,{primary:n,secondary:l,primaryTypographyProps:{noWrap:!0,variant:"subtitle2"},secondaryTypographyProps:{noWrap:!0}})]}),e.jsx(me,{participant:s,open:o,onClose:t})]})}const Ds=ae(s=>e.jsx(b,{disableRipple:!0,...s}))(({theme:s})=>({right:0,zIndex:9,width:32,height:32,position:"absolute",top:s.spacing(1),boxShadow:s.customShadows.z8,backgroundColor:s.palette.background.paper,border:`solid 1px ${s.palette.divider}`,borderRight:0,borderRadius:"12px 0 0 12px",transition:s.transitions.create("all"),"&:hover":{backgroundColor:s.palette.background.neutral}})),F=240;ve.propTypes={participants:a.array,conversation:a.object};function ve({conversation:s,participants:o}){const t=oe(),r=G("up","lg"),[n,i]=f.useState(!0),[c,l]=f.useState(!0),[d,x]=f.useState(!0),[h,y]=f.useState(!0),[v,j]=f.useState(null),T=()=>{i(!0)},C=()=>{i(!1)},p=o.length>1;f.useEffect(()=>{r?T():C()},[r]);const w=e.jsxs(e.Fragment,{children:[p?e.jsx(je,{selectUserId:v,participants:o,isCollapse:h,onCollapse:()=>y(!h),onOpenUserInfo:k=>j(k)}):e.jsx(ue,{participant:o[0],isCollapse:c,onCollapse:()=>l(!c)}),e.jsx(xe,{conversation:s,isCollapse:d,onCollapse:()=>x(!d)})]});return e.jsxs(I,{sx:{position:"relative"},children:[e.jsx(Ds,{onClick:()=>i(!n),sx:{...n&&r&&{right:F}},children:e.jsx(u,{width:16,icon:n?"eva:arrow-ios-forward-fill":"eva:arrow-ios-back-fill"})}),r?e.jsx(_,{open:n,anchor:"right",variant:"persistent",PaperProps:{sx:{width:1,position:"static"}},sx:{height:1,width:F,transition:t.transitions.create("width"),...!n&&{width:0}},children:w}):e.jsx(_,{anchor:"right",open:n,onClose:C,ModalProps:{keepMounted:!0},PaperProps:{sx:{width:F}},children:w})]})}const Ps="8864c717-587d-472a-929a-8e5f298024da-0";ye.propTypes={sx:a.object,onSend:a.func,disabled:a.bool,conversationId:a.string};function ye({disabled:s,conversationId:o,onSend:t,sx:r,...n}){const i=f.useRef(null),[c,l]=f.useState(""),d=()=>{var h;(h=i.current)==null||h.click()},x=h=>{h.key==="Enter"&&(console.log("Enter"),t&&c&&o&&t({conversationId:o,messageId:ws(),message:c,contentType:"text",attachments:[],createdAt:new Date,senderId:Ps}),l(""))};return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{value:c,onKeyUp:x,onChange:h=>l(h.target.value),placeholder:"Type a message",startAdornment:e.jsx(se,{position:"start",children:e.jsx(b,{size:"small",children:e.jsx(u,{icon:"eva:smiling-face-fill"})})}),endAdornment:e.jsxs(m,{direction:"row",spacing:1,sx:{flexShrink:0,mr:1.5},children:[e.jsx(b,{disabled:s,size:"small",onClick:d,children:e.jsx(u,{icon:"ic:round-add-photo-alternate"})}),e.jsx(b,{disabled:s,size:"small",onClick:d,children:e.jsx(u,{icon:"eva:attach-2-fill"})}),e.jsx(b,{disabled:s,size:"small",children:e.jsx(u,{icon:"eva:mic-fill"})})]}),sx:{pl:1,height:56,flexShrink:0,borderTop:h=>`solid 1px ${h.palette.divider}`,...r},...n}),e.jsx("input",{type:"file",ref:i,style:{display:"none"}})]})}const Ms="8864c717-587d-472a-929a-8e5f298024da-0";be.propTypes={message:a.object,conversation:a.object,onOpenLightbox:a.func,ccData:a.object,ccMessage:a.array};function be({message:s,conversation:o,onOpenLightbox:t,ccData:r,ccMessage:n}){console.log(n),o.participants.find(h=>h.id===s.senderId);const i=s.senderId===Ms?{type:"me"}:{avatar:r.from.profile.avatar_url,name:r.from.profile.first_name},c=i.type==="me",l=s.contentType==="image",d=i.name&&i.name.split(" ")[0],x=n.sender_id;return console.log(x),e.jsxs(m,{direction:"row",justifyContent:c?"flex-end":"unset",sx:{mb:3},children:[!c&&e.jsx(P,{alt:i.name,src:i.avatar,sx:{width:32,height:32,mr:2}}),e.jsxs(m,{spacing:1,alignItems:"flex-end",children:[e.jsxs(S,{noWrap:!0,variant:"caption",sx:{color:"text.disabled",...!c&&{mr:"auto"}},children:[!c&&`${d},`," Â ",re(new Date(s.createdAt),{addSuffix:!0})]}),e.jsx(m,{sx:{p:1.5,minWidth:48,maxWidth:320,borderRadius:1,overflow:"hidden",typography:"body2",bgcolor:"background.neutral",...c&&{color:"grey.800",bgcolor:"primary.lighter"},...l&&{p:0}},children:l?e.jsx(Ye,{alt:"attachment",src:s.body,onClick:()=>t(s.body),sx:{cursor:"pointer","&:hover":{opacity:.9}}}):s.body})]})]})}Ce.propTypes={conversation:a.object,ccData:a.object};function Ce({conversation:s,ccData:o}){o[0],console.log(o);const t=f.useRef(null),[r,n]=f.useState(-1),i=s.messages.filter(l=>l.contentType==="image").map(l=>({src:l.body})),c=()=>{n(-1)};return console.log(o),e.jsxs(e.Fragment,{children:[e.jsx(E,{scrollableNodeProps:{ref:t},sx:{p:3,height:1},children:o.map(l=>e.jsx(be,{ccMessage:l}))}),e.jsx(Ss,{index:r,slides:i,open:r>=0,close:c})]})}we.propTypes={participants:a.array};function we({participants:s}){const o=s.length>1,t=s.length?s[0]:null;return e.jsxs(m,{direction:"row",alignItems:"center",sx:{p:r=>r.spacing(2,1,2,2)},children:[o?e.jsxs(m,{flexGrow:1,children:[e.jsx(Ke,{max:3,children:s.map(r=>e.jsx(A,{alt:r.name,src:r.avatar},r.id))}),e.jsxs(Je,{variant:"body2",sx:{mt:.5,alignItems:"center",display:"inline-flex",color:"text.secondary"},children:[s.length," persons",e.jsx(u,{icon:"eva:arrow-ios-forward-fill",width:16})]})]}):e.jsxs(m,{flexGrow:1,direction:"row",alignItems:"center",spacing:2,children:[e.jsx(A,{src:t==null?void 0:t.avatar,alt:t==null?void 0:t.name,BadgeProps:{badgeContent:e.jsx(D,{status:t==null?void 0:t.status})}}),e.jsxs("div",{children:[e.jsx(S,{variant:"subtitle2",children:t==null?void 0:t.name}),e.jsx(S,{variant:"body2",sx:{color:"text.secondary"},children:(t==null?void 0:t.status)==="offline"?(t==null?void 0:t.lastActivity)&&Qe(t==null?void 0:t.lastActivity):e.jsx(I,{component:"span",sx:{textTransform:"capitalize"},children:t==null?void 0:t.status})})]})]}),e.jsx(b,{children:e.jsx(u,{icon:"eva:phone-fill"})}),e.jsx(b,{children:e.jsx(u,{icon:"eva:video-fill"})}),e.jsx(b,{children:e.jsx(u,{icon:"eva:more-vertical-fill"})})]})}Se.propTypes={sx:a.object,contacts:a.array,recipients:a.array,onAddRecipients:a.func};function Se({contacts:s,recipients:o,onAddRecipients:t,sx:r,...n}){const[i,c]=f.useState(""),l=d=>{c(""),t(d)};return e.jsxs(m,{spacing:1,direction:"row",alignItems:"center",sx:{py:2,px:2.5,...r},...n,children:[e.jsx(S,{variant:"subtitle2",sx:{color:"text.secondary"},children:"To:"}),e.jsx(Xe,{sx:{minWidth:240},multiple:!0,popupIcon:null,noOptionsText:e.jsx(ne,{query:i}),onChange:(d,x)=>l(x),onInputChange:(d,x)=>c(x),options:s,getOptionLabel:d=>d.name,renderInput:d=>e.jsx(Ze,{...d,size:"small",placeholder:o.length?"+Recipients":""}),renderOption:(d,x,{inputValue:h,selected:y})=>{const{name:v,avatar:j}=x,T=es(v,h),C=ss(v,T);return e.jsxs(I,{component:"li",sx:{p:"12px !important"},...d,children:[e.jsxs(I,{sx:{mr:1.5,width:32,height:32,overflow:"hidden",borderRadius:"50%",position:"relative"},children:[e.jsx(P,{alt:v,src:j}),e.jsx(I,{sx:{top:0,opacity:0,width:"100%",height:"100%",display:"flex",position:"absolute",alignItems:"center",justifyContent:"center",bgcolor:p=>ts(p.palette.grey[900],.8),transition:p=>p.transitions.create("opacity",{easing:p.transitions.easing.easeInOut,duration:p.transitions.duration.shorter}),...y&&{opacity:1,color:"primary.main"}},children:e.jsx(u,{icon:"eva:checkmark-fill"})})]}),C.map((p,w)=>e.jsx(S,{variant:"subtitle2",color:p.highlight?"primary":"textPrimary",children:p.text},w))]})},renderTags:(d,x)=>d.map((h,y)=>f.createElement(ns,{...x({index:y}),key:h.id,size:"small",label:h.name,avatar:e.jsx(P,{alt:h.name,src:h.avatar})}))})]})}const _s="8864c717-587d-472a-929a-8e5f298024da-0";function Os(){const{themeStretch:s}=os(),o=as(),t=B(),{pathname:r}=rs(),{conversationKey:n=""}=is(),{contacts:i,recipients:c,participants:l,activeConversationId:d,conversations:x,ccData:h}=q(p=>p.chat);console.log(h);const y=q(()=>d?x.byId[d]:{id:"",messages:[],participants:[],unreadCount:0,type:""});h[0];const v=!!n,j=l.filter(p=>p.id!==_s);f.useEffect(()=>{o(ls()),o(cs()),o(ds())},[o]),f.useEffect(()=>{n?(async()=>{o(us(`${n}`));try{await o(ms(`${n}`))}catch(w){console.error(w),t(N.chat.new)}})():d&&o(hs())},[n]),f.useEffect(()=>{d&&o(xs(d))},[o,d]);const T=p=>{o(fs(p))},C=async p=>{try{o(js(p))}catch(w){console.error(w)}};return e.jsxs(ps,{maxWidth:s?!1:"xl",children:[e.jsx(vs,{heading:"Chat",links:[{name:"Dashboard",href:N.root},{name:"Chat"}]}),e.jsxs(Ts,{sx:{height:"72vh",display:"flex"},children:[e.jsx(he,{ccData:h,conversations:x,activeConversationId:d}),e.jsxs(m,{flexGrow:1,sx:{overflow:"hidden"},children:[v?e.jsx(we,{participants:j}):e.jsx(Se,{recipients:c,contacts:Object.values(i.byId),onAddRecipients:T}),e.jsxs(m,{direction:"row",flexGrow:1,sx:{overflow:"hidden",borderTop:p=>`solid 1px ${p.palette.divider}`},children:[e.jsxs(m,{flexGrow:1,sx:{minWidth:0},children:[e.jsx(Ce,{ccData:h,conversation:y}),e.jsx(ye,{conversationId:d,onSend:C,disabled:r===N.chat.root||r===N.chat.new})]}),v&&e.jsx(ve,{conversation:y,participants:j})]})]})]})]})}function qs(){return e.jsxs(e.Fragment,{children:[e.jsx(gs,{children:e.jsx("title",{children:" Chat | Minimal UI"})}),e.jsx(Os,{})]})}export{qs as default};
